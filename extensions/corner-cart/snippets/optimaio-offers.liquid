<div id="optimaio-offers-section" class="optimaio-offers-section">
  <h3>Exclusive Offers üéâ</h3>
  <ul id="optimaio-offers-list" class="optimaio-offers-list">
    <li>Loading offers...</li>
  </ul>
</div>

<script>
(function(){
  const renderOffers = () => {
    const campaigns = window.OptimaioCampaigns || [];
    const list = document.getElementById("optimaio-offers-list");
    if (!list) return;
    list.innerHTML = "";

    if (!campaigns.length) {
      list.innerHTML = "<li>No active offers available</li>";
      return;
    }

    campaigns
      .filter(c => c.status === "active")
      .forEach(c => {
        const li = document.createElement("li");
        li.className = "optimaio-offer-item";

        let html = `<strong>${c.campaignName}</strong>`;
        c.goals.forEach(g => {
          switch (g.type) {
            case "free_shipping":
              html += `<p>üöö Free shipping on ${g.target}+ items</p>`;
              break;
            case "order_discount":
              html += `<p>üí∏ ${g.discountValue}% off on ${g.target}+ items</p>`;
              break;
            case "free_product":
              html += `<p>üéÅ Free ${g.giftQty || 1} product${(g.giftQty>1)?'s':''} on ${g.target}+ items</p>`;
              if (g.products?.length) {
                html += `<div class="offer-products">${g.products.map(p => `
                  <div class="offer-product">
                    <img src="${p.image?.url}" alt="${p.productTitle}">
                    <span>${p.productTitle}</span>
                  </div>`).join('')}</div>`;
              }
              break;
            default:
              if (g.discountType === "free_product" && g.getProducts?.length) {
                const buy = g.buyProducts.map(p => p.productTitle).join(", ");
                const get = g.getProducts.map(p => p.productTitle).join(", ");
                html += `<p>üõçÔ∏è Buy ${g.buyQty} ${buy} get ${g.getQty} ${get} free</p>`;
              }
          }
        });

        li.innerHTML = html;
        list.appendChild(li);
      });
  };

  // Run once DOM ready
  document.addEventListener("DOMContentLoaded", () => {
    if (window.OptimaioCampaigns) renderOffers();
    else document.addEventListener("optimaio:campaigns:ready", renderOffers);
  });
})();
</script>

<style>
.optimaio-offers-list { list-style:none;padding:0;margin:0; }
.optimaio-offer-item { background:#fafafa;margin:8px 0;padding:12px;border-radius:8px; }
.offer-products { display:flex;gap:10px;margin-top:6px;flex-wrap:wrap; }
.offer-product { text-align:center; }
.offer-product img { width:60px;height:60px;border-radius:6px;object-fit:cover; }
.offer-product span { display:block;font-size:12px;margin-top:4px; }
</style>
